View(d)
p=ggplot(d,aes(x=x,y=z))+geom_point()
p
x=seq(0,2,2/(p-1))
d=data.table(x,z=2.5*x^3+rnorm(p,0,3))
View(d)
p=ggplot(d,aes(x=x,y=z))+geom_point()
p
x=seq(0,2,2/(p-1))
d=data.table(x,z=2.5*x^3+rnorm(p,0,3))
View(d)
p=ggplot(d,aes(x=x,y=z))+geom_point()
p
x=seq(0,2,2/(p-1))
d=data.table(x,z=2.5*x^3+rnorm(p,0,3))
View(d)
p=ggplot(d,aes(x=x,y=z))+geom_point()
p
x=seq(0,2,2/(p-1))
d=data.table(x,z=2.5*x^3+rnorm(p,0,3))
View(d)
p=ggplot(d,aes(x=x,y=z))+geom_point()
p
x=seq(0,2,2/(p-1))
d=data.table(x,z=2.5*x^3+rnorm(p,0,3))
View(d)
p=ggplot(d,aes(x=x,y=z))+geom_point()
p
x=seq(0,2,2/(p-1))
d=data.table(x,z=2*x^3+rnorm(p,0,3))
View(d)
p=ggplot(d,aes(x=x,y=z))+geom_point()
p
x=seq(0,2,2/(p-1))
d=data.table(x,z=2*x^3+rnorm(p,0,3))
View(d)
p=ggplot(d,aes(x=x,y=z))+geom_point()
p
x=seq(0,2,2/(p-1))
d=data.table(x,z=2*x^3+rnorm(p,0,3))
View(d)
p=ggplot(d,aes(x=x,y=z))+geom_point()
p
x=seq(0,2,2/(p-1))
d=data.table(x,z=2*x^3+rnorm(p,0,3))
View(d)
p=ggplot(d,aes(x=x,y=z))+geom_point()
p
x=seq(0,2,2/(p-1))
d=data.table(x,z=2*x^3+rnorm(p,0,3))
View(d)
p=ggplot(d,aes(x=x,y=z))+geom_point()
p
x=seq(0,2,2/(p-1))
d=data.table(x,z=2*x^3+rnorm(p,0,3))
View(d)
p=ggplot(d,aes(x=x,y=z))+geom_point()
p
data_creater(p){
#p=number of points
x=seq(0,2,2/(p-1))
d=data.table(x,z=2*x^3+rnorm(p,0,3))
View(d)
p=ggplot(d,aes(x=x,y=z))+geom_point()
print(p)
}
data_creater=function(p){
#p=number of points
x=seq(0,2,2/(p-1))
d=data.table(x,z=2*x^3+rnorm(p,0,3))
View(d)
p=ggplot(d,aes(x=x,y=z))+geom_point()
print(p)
}
data_creater(15)
data_creater(30)
data_creater(4)
data_creater=function(p){
#p=number of points
x=seq(0,2,2/(p-1))
d=data.table(x,z=2*x^3+rnorm(p,0,3))
View(d)
p=ggplot(d,aes(x=x,y=z))+geom_point()
print(p)
return(d)
}
d=data_creater(30)
d
ess_counter=function(k,d){
options(warn=-1) #it is a technical thing - cbind doesnt work properly
data_fun=data.table(z=d$z)
while(k>0){
data_fun=data.table(cbind(data_fun,d$x^k))
k=k-1
}
for (i in 2:ncol(data_fun)) names(data_fun)[i]=paste(ncol(data_fun)-i+1)
m=lm(data=data_fun, z~.)
ess=sum((m$fitted.values-data_fun$z)^2)
return(summary(m))
}
ess_counter(4,data_creater(30))
ess_counter=function(k,d){
options(warn=-1) #it is a technical thing - cbind doesnt work properly
data_fun=data.table(z=d$z)
while(k>0){
data_fun=data.table(cbind(data_fun,d$x^k))
k=k-1
}
for (i in 2:ncol(data_fun)) names(data_fun)[i]=paste(ncol(data_fun)-i+1)
m=lm(data=data_fun, z~.)
ess=sum((m$fitted.values-data_fun$z)^2)
return(ess)
}
##lets see an example.
ess_counter(4,data_creater(30))
d
nrow(d)
simulate_ess=function(d){
k=nrow(d)
ess_ls=data.table(degree=1:k,ess=rep(0,k))
for (i in 1:k) ess_ls$ess=ess_counter(k,d)
return(ess_ls)
}
simulate_ess(data_creater(30))
simulate_ess(data_creater(30))
simulate_ess(data_creater(30))
simulate_ess(data_creater(30))
##lets see an example.
ess_counter(4,data_creater(30))
ess_counter=function(k,d){
options(warn=-1) #it is a technical thing - cbind doesnt work properly
data_fun=data.table(z=d$z)
while(k>0){
data_fun=data.table(cbind(data_fun,d$x^k))
k=k-1
}
for (i in 2:ncol(data_fun)) names(data_fun)[i]=paste(ncol(data_fun)-i+1)
m=lm(data=data_fun, z~.)
ess=sum((m$fitted.values-data_fun$z)^2)
return(summary(m))
}
##lets see an example.
ess_counter(4,data_creater(30))
##lets see an example.
ess_counter(4,data_creater(30))
##lets see an example.
ess_counter(4,data_creater(30))
##lets see an example.
ess_counter(4,data_creater(30))
##lets see an example.
ess_counter(6,data_creater(30))
##lets see an example.
ess_counter(6,data_creater(30))
##lets see an example.
ess_counter(20,data_creater(30))
##lets see an example.
ess_counter(30,data_creater(30))
##lets see an example.
ess_counter(50,data_creater(30))
data_creater=function(p){
#p=number of points
x=seq(0,2,2/(p-1))
d=data.table(x,z=2*x^3+rnorm(p,0,3))
View(d)
p=ggplot(d,aes(x=x,y=z))+geom_point()
print(p)
return(d)
}
data_creater(50)
ess_counter=function(k,d){
options(warn=-1) #it is a technical thing - cbind doesnt work properly
data_fun=data.table(z=d$z)
while(k>0){
data_fun=data.table(cbind(data_fun,d$x^k))
k=k-1
}
for (i in 2:ncol(data_fun)) names(data_fun)[i]=paste(ncol(data_fun)-i+1)
View(data_fun)
m=lm(data=data_fun, z~.)
ess=sum((m$fitted.values-data_fun$z)^2)
return(summary(m))
}
##lets see an example.
ess_counter(5,data_creater(30))
0.06896522^3
m=lm(data=data_fun, z~.)
ess_counter=function(k,d){
options(warn=-1) #it is a technical thing - cbind doesnt work properly
data_fun=data.table(z=d$z)
while(k>0){
data_fun=data.table(cbind(data_fun,d$x^k))
k=k-1
}
for (i in 2:ncol(data_fun)) names(data_fun)[i]=paste(ncol(data_fun)-i+1)
View(data_fun)
m=lm(data=data_fun, z~.)
ess=sum((m$fitted.values-data_fun$z)^2)
return(data_fun)
}
t=ess_counter(5,data_creater(30))
t=ess_counter(5,data_creater(30))
m=lm(data=t,z~.)
summary(m)
m$fitted.values-data_fun$z
m$fitted.values-t$z
(m$fitted.values-t$z)^2
sum((m$fitted.values-t$z)^2)
ess_counter=function(k,d){
options(warn=-1) #it is a technical thing - cbind doesnt work properly
data_fun=data.table(z=d$z)
while(k>0){
data_fun=data.table(cbind(data_fun,d$x^k))
k=k-1
}
for (i in 2:ncol(data_fun)) names(data_fun)[i]=paste(ncol(data_fun)-i+1)
View(data_fun)
m=lm(data=data_fun, z~.)
ess=sum((m$fitted.values-data_fun$z)^2)
return(ess)
}
##lets see an example.
ess_counter(5,data_creater(30))
data_creater=function(p){
#p=number of points
x=seq(0,2,2/(p-1))
d=data.table(x,z=2*x^3+rnorm(p,0,3))
p=ggplot(d,aes(x=x,y=z))+geom_point()
print(p)
return(d)
}
ess_counter=function(k,d){
options(warn=-1) #it is a technical thing - cbind doesnt work properly
data_fun=data.table(z=d$z)
while(k>0){
data_fun=data.table(cbind(data_fun,d$x^k))
k=k-1
}
for (i in 2:ncol(data_fun)) names(data_fun)[i]=paste(ncol(data_fun)-i+1)
View(data_fun)
m=lm(data=data_fun, z~.)
ess=sum((m$fitted.values-data_fun$z)^2)
return(ess)
}
##lets see an example.
ess_counter(5,data_creater(30))
##lets see an example.
ess_counter(5,data_creater(30))
##lets see an example.
ess_counter(5,data_creater(30))
data_creater=function(p){
#p=number of points
x=seq(0,2,2/(p-1))
d=data.table(x,z=2*x^3+rnorm(p,0,3))
p=ggplot(d,aes(x=x,y=z))+geom_point()+ggtitle("The raw data")
print(p)
return(d)
}
ess_counter=function(k,d){
options(warn=-1) #it is a technical thing - cbind doesnt work properly
data_fun=data.table(z=d$z)
while(k>0){
data_fun=data.table(cbind(data_fun,d$x^k))
k=k-1
}
for (i in 2:ncol(data_fun)) names(data_fun)[i]=paste(ncol(data_fun)-i+1)
View(data_fun)
m=lm(data=data_fun, z~.)
ess=sum((m$fitted.values-data_fun$z)^2)
return(ess)
}
##lets see an example.
ess_counter(5,data_creater(30))
ess_counter=function(k,d){
#options(warn=-1) #it is a technical thing - cbind doesnt work properly
data_fun=data.table(z=d$z)
while(k>0){
data_fun=data.table(cbind(data_fun,d$x^k))
k=k-1
}
for (i in 2:ncol(data_fun)) names(data_fun)[i]=paste(ncol(data_fun)-i+1)
View(data_fun)
m=lm(data=data_fun, z~.)
ess=sum((m$fitted.values-data_fun$z)^2)
return(ess)
}
##lets see an example.
ess_counter(5,data_creater(30))
data_creater=function(p){
#p=number of points
x=seq(0,2,2/(p-1))
d=data.table(x,z=2*x^3+rnorm(p,0,3))
p=ggplot(d,aes(x=x,y=z))+geom_point()+ggtitle("The raw data")
print(p)
return(d)
}
ess_counter=function(k,d){
data_fun=data.table(z=d$z)
while(k>0){
data_fun=data.table(cbind(data_fun,d$x^k))
k=k-1
}
for (i in 2:ncol(data_fun)) names(data_fun)[i]=paste(ncol(data_fun)-i+1)
View(data_fun)
m=lm(data=data_fun, z~.)
ess=sum((m$fitted.values-data_fun$z)^2)
return(ess)
}
##lets see an example.
ess_counter(5,data_creater(30))
ess_counter=function(k,d){
data_fun=data.table(z=d$z)
while(k>0){
data_fun=data.table(cbind(data_fun,d$x^k))
k=k-1
}
for (i in 2:ncol(data_fun)) names(data_fun)[i]=paste(ncol(data_fun)-i+1)
View(data_fun)
m=lm(data=data_fun, z~.)
ess=sum((m$fitted.values-data_fun$z)^2)
ls=list(data_fun,ess)
return(ls)
}
t=ess_counter(5,data_creater(30))
t
t$ess
t[[2]]
t=ess_counter(15,data_creater(30))
t[[2]]
##lets see an example.
t=ess_counter(30,data_creater(30))
t[[2]]
nrow(t[[1]])
ncol(t[[1]])
ess_counter=function(k,d){
data_fun=data.table(z=d$z)
while(k>0){
data_fun=data.table(cbind(data_fun,d$x^k))
k=k-1
}
for (i in 2:ncol(data_fun)) names(data_fun)[i]=paste(ncol(data_fun)-i+1)
m=lm(data=data_fun, z~.)
ess=sum((m$fitted.values-data_fun$z)^2)
ls=list(data_fun,ess)
return(ls)
}
simulate_ess=function(m){
q=data_creater(m)
ess_sol=data.table(degree=1:m,ess=rep(0,m))
for (i in 1:m) ess_sol$ess=ess_counter(i,q)[[2]]
}
simulate_ess(20)
simulate_ess=function(m){
q=data_creater(m)
ess_sol=data.table(degree=1:m,ess=rep(0,m))
for (i in 1:m) ess_sol$ess=ess_counter(i,q)[[2]]
return(ess_sol)
}
simulate_ess(20)
m=20
q=data_creater(m)
q
ess_sol=data.table(degree=1:m,ess=rep(0,m))
for (i in 1:m) ess_sol$ess=ess_counter(i,q)[[2]]
ess_sol
ess_counter(3,q)
ess_counter(10,q)
ess_counter(18,q)
simulate_ess=function(m){
q=data_creater(m)
ess_sol=data.table(degree=1:m,ess=rep(0,m))
for (i in 1:m) ess_sol$ess[i]=ess_counter(i,q)[[2]]
return(ess_sol)
}
simulate_ess(20)
simulate_ess(30)
q=data.table(rep(0,30))
for (i in 1:5) q=cbind(q,data.table(simulate_ess(30)))
q
q=data.table(rep(0,30))
for (i in 1:5) q=cbind(q,data.table(simulate_ess(30)[,2]))
q
data_creater=function(p){
#p=number of points
x=seq(0,2,2/(p-1))
d=data.table(x,z=2*x^3+rnorm(p,0,3))
#p=ggplot(d,aes(x=x,y=z))+geom_point()+ggtitle("The raw data")
#print(p)
return(d)
}
ess_counter=function(k,d){
data_fun=data.table(z=d$z)
while(k>0){
data_fun=data.table(cbind(data_fun,d$x^k))
k=k-1
}
for (i in 2:ncol(data_fun)) names(data_fun)[i]=paste(ncol(data_fun)-i+1)
m=lm(data=data_fun, z~.)
ess=sum((m$fitted.values-data_fun$z)^2)
ls=list(data_fun,ess)
return(ls)
}
simulate_ess=function(m){
q=data_creater(m)
ess_sol=data.table(degree=1:m,ess=rep(0,m))
for (i in 1:m) ess_sol$ess[i]=ess_counter(i,q)[[2]]
return(ess_sol)
}
q=data.table(degree=1:30)
for (i in 1:100) q=cbind(q,data.table(simulate_ess(30)[,2]))
q$mean=apply(q[,-1],1,mean())
q$mean=apply(q[,-1],2,mean())
q
q[,-1]
q$mean=apply(q[,-1],2,mean())
q$mean=apply(q[,-1],2,mean)
q$meanm
q$mean
q$mean=apply(q[,-1],1,mean)
q$mean
q$variance=apply(q[,-1],1,Var)
q$variance
q$variance=apply(q[,-1],1,sd)
q$variance
q$sd=apply(q[,-1],1,sd)
ess_solution=data.table(degree=1:30,ess=q$mean,stand.error=q$sd)
ggplot(ess_solution,aes(x=degree,y=ess))+geom_point()+geom_smooth(method="lm")
ggplot(ess_solution,aes(x=degree,y=ess))+geom_point()
rm(list=ls())
setwd("C:/Users/User/Documents/GitHub/learning_repo")
source("header.R")
data_creater=function(p){
#p=number of points
x=seq(0,2,2/(p-1))
d=data.table(x,z=2*x^3+rnorm(p,0,3))
#p=ggplot(d,aes(x=x,y=z))+geom_point()+ggtitle("The raw data")
#print(p)
return(d)
}
ess_counter=function(k,d){
data_fun=data.table(z=d$z)
while(k>0){
data_fun=data.table(cbind(data_fun,d$x^k))
k=k-1
}
for (i in 2:ncol(data_fun)) names(data_fun)[i]=paste(ncol(data_fun)-i+1)
m=lm(data=data_fun, z~.)
ess=sum((m$fitted.values-data_fun$z)^2)
ls=list(data_fun,ess)
return(ls)
}
simulate_ess=function(m){
q=data_creater(m)
ess_sol=data.table(degree=1:m,ess=rep(0,m))
for (i in 1:m) ess_sol$ess[i]=ess_counter(i,q)[[2]]
return(ess_sol)
}
##lets see an example.
t=ess_counter(30,data_creater(30))
t[[1]]
##lets see an example.
t=ess_counter(5,data_creater(30))
t[[1]]
t[[2]]
simulate_ess(30)
q=data.table(degree=1:30)
for (i in 1:100) q=cbind(q,data.table(simulate_ess(30)[,2]))
q$mean=apply(q[,-1],1,mean)
q$sd=apply(q[,-1],1,sd)
ess_solution=data.table(degree=1:30,ess=q$mean,stand.error=q$sd)
ggplot(ess_solution,aes(x=degree,y=ess))+geom_point()+ggtitle("The ess converges to zero as the degree increases. Overfitting is detected.")
setwd("C:/Users/User/Documents/GitHub/learning_repo")
source("header.R")
data_creater=function(p){
#p=number of points
x=seq(0,2,2/(p-1))
d=data.table(x,z=2*x^3+rnorm(p,0,3))
#p=ggplot(d,aes(x=x,y=z))+geom_point()+ggtitle("The raw data")
#print(p)
return(d)
}
ess_counter=function(k,d){
#k is the number of degrees, d is the datatable
data_fun=data.table(z=d$z)
while(k>0){
data_fun=data.table(cbind(data_fun,d$x^k))
k=k-1
}
for (i in 2:ncol(data_fun)) names(data_fun)[i]=paste(ncol(data_fun)-i+1)
m=lm(data=data_fun, z~.)
ess=sum((m$fitted.values-data_fun$z)^2)
ls=list(data_fun,ess)
return(ls)
}
simulate_ess=function(m){
#m is the number of rows of the data table
q=data_creater(m)
ess_sol=data.table(degree=1:m,ess=rep(0,m))
for (i in 1:m) ess_sol$ess[i]=ess_counter(i,q)[[2]]
return(ess_sol)
}
##lets see an example.
t=ess_counter(5,data_creater(30))
t[[1]]
t[[2]]
simulate_ess(19)
simulate_ess(22)
q=data.table(degree=1:19)
for (i in 1:100) q=cbind(q,data.table(simulate_ess(19)[,2]))
q$mean=apply(q[,-1],1,mean)
q$sd=apply(q[,-1],1,sd)
ess_solution=data.table(degree=1:19,ess=q$mean,stand.error=q$sd)
ggplot(ess_solution,aes(x=degree,y=ess))+geom_point()+ggtitle("The ess converges to zero as the degree increases. Overfitting is detected.")
